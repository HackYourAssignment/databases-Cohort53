# 3.1 — SQL Normalization

## 1. What violates 1NF?

- `food_code = "C1, C2"` → multiple values in a single column.
- `food_description = "Curry, Cake"` → same issue.
- `dinner_date` → inconsistent formats (`2020-03-15`, `20-03-2020`, `Mar 25 '20`). It should always be stored as `DATE`.

## 2. What entities can be extracted?

- **Members** (club members)
- **Dinners** (events)
- **Venues** (locations)
- **Foods** (dishes)

Relationships:

- Members ↔ Dinners (many-to-many, attendance)
- Dinners ↔ Foods (many-to-many, menu)
- Dinners → Venues (many-to-one)

## 3. 3NF-compliant design

```sql
-- Members table
CREATE TABLE members (
  member_id      INTEGER PRIMARY KEY,
  member_name    TEXT NOT NULL,
  member_address TEXT
);

-- Venues table
CREATE TABLE venues (
  venue_code        TEXT PRIMARY KEY,
  venue_description TEXT NOT NULL
);

-- Dinners table
CREATE TABLE dinners (
  dinner_id   TEXT PRIMARY KEY,   -- e.g. D00001001
  dinner_date DATE NOT NULL,
  venue_code  TEXT NOT NULL REFERENCES venues(venue_code)
);

-- Foods table
CREATE TABLE foods (
  food_code        TEXT PRIMARY KEY,   -- e.g. C1, S1, P1
  food_description TEXT NOT NULL
);

-- Attendance table (members attending dinners, many-to-many)
CREATE TABLE dinner_attendance (
  dinner_id TEXT    NOT NULL REFERENCES dinners(dinner_id) ON DELETE CASCADE,
  member_id INTEGER NOT NULL REFERENCES members(member_id) ON DELETE CASCADE,
  PRIMARY KEY (dinner_id, member_id)
);

-- Dinner-foods table (foods served at each dinner, many-to-many)
CREATE TABLE dinner_foods (
  dinner_id TEXT NOT NULL REFERENCES dinners(dinner_id) ON DELETE CASCADE,
  food_code TEXT NOT NULL REFERENCES foods(food_code) ON DELETE RESTRICT,
  PRIMARY KEY (dinner_id, food_code)
);
```
